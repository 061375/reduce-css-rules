javascript:var Reduce={useajax:!1,filtered:{},phpurl:"_/php/ajax.php",body:{},init:function(a){"undefined"!=typeof a?this.useajax=a:"undefined"!=typeof overideReduce&&"undefined"!=typeof overideReduce.useajax&&(this.useajax=overideReduce.useajax),console.log("Reduce::init.ajax = "+this.useajax);var b=document.createElement("div");b.style.backgroundColor="rgba(0,0,0,0.6)",b.style.position="absolute",b.style.top="0px",b.style.left="0px",b.style.width="100%",b.style.height=window.innerHeight+"px",b.style.zIndex="9998",b.setAttribute("id","reduce_d5gyurt-fader");var c=document.createElement("div");c.style.position="absolute",c.style.top="0px",c.style.left="0px",c.style.zIndex="9999",c.setAttribute("id","reduce_d5gyurt-container"),b.appendChild(c);var d=document.createElement("button");d.setAttribute("type","button"),d.style["float"]="left",d.innerHTML="Run",d.addEventListener("click",function(){Reduce.run()}),c.appendChild(d);var d=document.createElement("button");d.setAttribute("type","button"),d.style["float"]="left",d.innerHTML="Reset",d.addEventListener("click",function(){Reduce.reset()}),c.appendChild(d);var d=document.createElement("button");d.setAttribute("type","button"),d.style["float"]="left",d.innerHTML="Close",d.addEventListener("click",function(){document.getElementById("reduce_d5gyurt-container").remove(),document.getElementById("reduce_d5gyurt-fader").remove()}),c.appendChild(d),b.appendChild(c),document.getElementsByTagName("body")[0].appendChild(b)},run:function(){if(this.useajax)this.runajax();else{var a=window.localStorage.getItem("filtered");console.log(a),null==a?Reduce.filtered={}:Reduce.filtered=JSON.parse(a),Reduce.body=document.getElementsByTagName("body")[0].getElementsByTagName("*"),l=Reduce.body.length;for(var b=l;b--;)Reduce.gatherRules(Reduce.body[b]);var c=Reduce.makeSheet(Reduce.filtered);console.log("\n\n\nReduce.run :: sheet"),console.log(c),window.localStorage.setItem("filtered",JSON.stringify(Reduce.filtered))}},runajax:function(){this.ajax(this.phpurl,function(a){"undefined"!=typeof a.json&&(Reduce.filtered=JSON.parse(a.json),console.log("Reduce.run :: Reduce.filtered"),console.log(Reduce.filtered)),Reduce.body=document.getElementsByTagName("body")[0].getElementsByTagName("*"),l=Reduce.body.length;for(var b=l;b--;)Reduce.gatherRules(Reduce.body[b]);var c=Reduce.makeSheet(Reduce.filtered);console.log("\n\n\nReduce.run :: sheet"),console.log(c),Reduce.ajax(Reduce.phpurl,function(a){alert(a)},{method:"setStyle",data:{domain:window.location.hostname,sheet:c,json:Reduce.filtered}})},{method:"getStyle",data:{domain:window.location.hostname}})},reset:function(){this.useajax?Reduce.ajax(Reduce.phpurl,function(a){alert(a)},{method:"resetDirectory",data:{domain:window.location.hostname}}):window.localStorage.removeItem("filtered")},ajax:function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=Reduce.parseStyleSheet(this.responseText);if("undefined"==typeof a.success)return alert("an unknown error occured"),!1;if(0==a.success){var c="";for(var d in a.message)c+=a.message[d]+"\n";return alert("Errors: "+c),!1}b(a.message)}},d.open("POST",a,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded");var e="";for(i in c)if("object"==typeof c[i])for(j in c[i])e+="object"==typeof c[i][j]?i+"["+j+"]="+JSON.stringify(c[i][j])+"&":i+"["+j+"]="+c[i][j]+"&";else e+=i+"="+c[i]+"&";e=e.substring(0,e.length-1),d.send(e)},parseStyleSheet:function(a){return JSON.parse(a)},gatherRules:function(a){var b,c=document.styleSheets;for(var d in c){var e=c[d].rules||c[d].cssRules;for(var f in e){if("undefined"!=typeof e[f].selectorText){var g=document.querySelectorAll(e[f].selectorText);if(l=g.length,l>0)for(var h=0;h<l;h++)if(g[h].isSameNode(a)){var b=/{(.*)}/,i=e[f].cssText.match(b);if(null!=i){var j=a.getAttribute("style");j=i[0].replace(b,"$1").trim(),""!=j.trim()&&(Reduce.filtered[e[f].selectorText]=j)}}}if("undefined"!=typeof e[f].media&&e[f].media.length>0){var k="";for(var m in e[f].cssRules)"undefined"!=typeof e[f].cssRules[m].cssText&&(k+=e[f].cssRules[m].cssText);this.filtered[e[f].conditionText]=k}}}},makeSheet:function(a,b){var c="";for(var d in a)c+=d+"{"+a[d]+"}";if("undefined"!=typeof b&&b){var e=document.createElement("textarea");e.setAttribute("onclick","this.focus();this.select()"),e.setAttribute("readonly","readonly"),e.style.zIndex="9999",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.width="1000px",e.style.height="1000px",e.innerHTML=c,Reduce.body[0].appendChild(e)}return c}};Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var a=this.length-1;a>=0;a--)this[a]&&this[a].parentElement&&this[a].parentElement.removeChild(this[a])},Reduce.init();void(0);